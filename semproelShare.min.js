/* semproelShare : A Pure Javascript Share Plugin. MIT - Copyright (c) 2016 Atok Fakhrudin */
!function(e,t){"use strict";e.semproelShare=t(e)}(window,function(e){"use strict";function t(e,t){var r=p.createElement("script");return r.async=!0,r.src=e+t,r}function r(e,t,r,n){e[t]=null,delete e[t],r.removeChild(n),n=null}function n(n){return new Promise(function(o,a){var i=e,l=p.body,u="kolbek"+Math.round(1e5*Math.random()),s=t(n,u);i[u]=function(e){o(e)},s.onerror=function(){a("Network error! Either you lost connection to the server before the data is received or error was occuring in the origin server of "+n),r(i,u,l,s)},s.onload=function(){r(i,u,l,s)},l.appendChild(s)})}function o(e,t,r){var n=t.screenX||t.screenLeft,o=t.screenY||t.screenTop,a=t.innerWidth||r.documentElement.clientWidth||r.body.clientWidth,i=t.innerHeight||r.documentElement.clientHeight||r.body.clientHeight,l=a/2-e.popupWidth/2+n,u=i/2-e.popupHeight/2+o,s=t.open(e.url,e.title,"width="+e.popupWidth+",height="+e.popupHeight+",top="+u+",left="+l+",titlebar=yes,toolbar=no,menubar=no,location=yes,resizable=no,scrollbars=yes,status=yes");return t.focus&&s.focus(),s}function a(t,r){var a,i=e,u=p,s=o({url:r[t].urlSharer,title:"Share on "+t,popupWidth:750,popupHeight:450},i,u),h=g[t];a=i.setInterval(function(){s.closed===!0&&(i.clearInterval(a),i.setTimeout(function(){n(r[t].urlCountGetter).then(r[t].success.bind(g)).then(function(e){c=c-h+e,l(""+c,f,P)},function(e){throw Error(m+'"Fetching '+t+" count error! Reason: "+e+'"')})},r[t].wait||0))},250)}function i(e){var t=[],r=e.platformKitchen,o=e.perPlatformCount;return e.sharePlatform.forEach(function(e,a){t[a]=n(r[e].urlCountGetter).then(r[e].success.bind(o),function(t){return console.log(Error(m+'"Fetching '+e+" count error! Reason: "+t+'"')),0})}),t}function l(e,t,r){var n=r[e.length]||r.deflt;n.functn.apply(arguments,n.argmnt)}function u(e){var t;e.preventDefault(),t=e.target,t.hasAttribute(h)?a(t.getAttribute(h),d):t.parentNode.hasAttribute(h)&&a(t.parentNode.getAttribute(h),d),e.stopPropagation()}function s(t){function r(){Promise.all(i({platformKitchen:d,sharePlatform:t.sharePlatform,perPlatformCount:g})).then(function(n){c=n.reduce(function(e,t){return e+t}),l(""+c,t.shareCount,P),e.removeEventListener("load",r)})["catch"](function(t){throw e.removeEventListener("load",r),Error(m+t)})}for(var n=["share","shareCount","sharePlatform","shareButtonContainer"],o=n.length;o--;)if(void 0===t[n[o]]||"string"!=typeof t[n[o]])throw Error(m+'"You are either missing required one object key (among these: "share", "shareCount", "sharePlatform", "shareButtonContainer") in your parameter or giving it a wrong type (while it must be a string). Please refer to the documentation."');if(!/^data-(?:[a-z]+-?)*(?:[a-z]+$)/.test(t.sharePlatform))throw Error("Your 'data-*' attribute for sharePlatform object key must follow this pattern (using all lowercase letters with no numbers): data-younamethis-or-and-with-this");var a=p;if(t.pageUrl=t.pageUrl||a.URL,t.pageTitle=t.pageTitle||a.title,t.pageDescription=t.pageDescription||a.head.querySelector("[name=description]").content||"",t.pageMedia=t.pageMedia||"",t.share=a.querySelector(t.share),t.shareCount=t.share.querySelector(t.shareCount),h=t.sharePlatform,t.sharePlatform=function(t){for(var r,n=t.share.querySelectorAll("["+t.sharePlatform+"]"),o=n.length,a=[],i=e,l=d;o--;){if(a[o]=n[o].getAttribute(t.sharePlatform),void 0===s.mediaPlatform[a[o]]||"function"!=typeof s.mediaPlatform[a[o]])throw Error(m+'One of your hook at "semproelShare.mediaPlatform.yourSocialMediaHook" is not available among values of "'+h+'". They should not duplicate (only one at hook and only one becomes the value of '+h+') and should correlate equally (i.e. be the same). For instance if at semproelShare.mediaPlatform hook is "semproelShare.mediaPlatform.facebook", then at '+h+' should look like "'+h+"='facebook'\". Another case, it may not be a function, while it should be.");r=i.encodeURI(t.pageUrl),l[a[o]]=new s.mediaPlatform[a[o]],l[a[o]].urlSharer=l[a[o]].urlSharer.replace("{{url}}",r).replace("{{title}}",i.encodeURIComponent(t.pageTitle)).replace("{{description}}",i.encodeURIComponent(t.pageDescription)).replace("{{media}}",i.encodeURI(t.pageMedia)),l[a[o]].urlCountGetter+=r+"&callback="}return a}(t),t.shareButtonContainer=t.share.querySelector(t.shareButtonContainer),null===t.share||null===t.shareCount||0===t.sharePlatform.length||null===t.shareButtonContainer)throw Error(m+'"Your CSS selector for one of these parameter {param.share, param.shareCount, param.sharePlatform, param.shareButtonContainer} does not match."');f=t.shareCount,e.addEventListener("load",r),t.shareButtonContainer.addEventListener("click",u,!1)}var c,h,f,m="semproelShare(): ",p=document,d={},g={},b=function(e,t,r,n,o){this[1].innerHTML=this[0].slice(e,t)+"."+this[0].slice(r,n)+o},v=function(e,t,r){this[1].innerHTML=this[0].slice(e,t)+r},y=function(){this[1].innerHTML=this[0]},P={4:{functn:b,argmnt:[0,1,1,2,"k"]},5:{functn:b,argmnt:[0,2,2,3,"k"]},6:{functn:v,argmnt:[0,3,"k"]},7:{functn:b,argmnt:[0,1,1,2,"m"]},8:{functn:b,argmnt:[0,2,2,3,"m"]},9:{functn:v,argmnt:[0,3,"m"]},10:{functn:b,argmnt:[0,1,1,2,"g"]},deflt:{functn:y,argmnt:[null]}};return s.mediaPlatform={},s});
